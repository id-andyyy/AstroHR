{% extends 'base.html' %}
{% block content %}
    <div class="container">
        <div class="center">
            <div class="panel-container">
                <h1 class="panel-title">Совместимость внутри команды</h1>
                <div class="team-selector">
                    <form method="post">
                        {% csrf_token %}
                        {% for field in form %}
                            {% include "astro_check/inc/_team_form.html" %}
                        {% endfor %}
                        <button type="submit" class="apply-button" name="first_form">Показать</button>
                    </form>
                </div>
                {% if workers %}
                    <table class="compatibility-table">
                        <thead>
                        <tr>
                            <th>ФИО</th>
                            <th>Роль</th>
                            <th>Процент совместимости с командой</th>
                        </tr>
                        </thead>
                        <tbody id="table-body">
                        {% for worker in workers %}
                            <tr class="team-worker">
                                <th>{{ worker.surname }} {{ worker.name }} {{ worker.patronymic }}</th>
                                <th>{{ worker.role_text }}</th>
                                <th>{{ worker.team_compatibility }}%</th>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                {% endif %}
            </div>
        </div>
    </div>

    <script>
        const teamData = {
            team1: [
                ["Иванов Иван", "Руководитель", "85%"],
                ["Петров Петр", "Frontend-разработчик", "90%"],
                ["Сидоров Сидор", "Backend-разработчик", "70%"],
                ["Егорова Екатерина", "Менеджер", "60%"],
                ["Коваленко Дмитрий", "Дизайнер", "75%"]
            ],
            team2: [
                ["Антонов Антон", "Руководитель", "88%"],
                ["Ильина Илона", "Маркетолог", "82%"],
                ["Смирнов Сергей", "DevOps", "77%"],
                ["Кузьмина Ольга", "Аналитик", "68%"],
                ["Богданов Борис", "UX-специалист", "80%"]
            ],
            team3: [
                ["Григорьев Григорий", "Архитектор", "91%"],
                ["Федоров Федор", "iOS-разработчик", "86%"],
                ["Семенова Светлана", "Тестировщик", "74%"],
                ["Бабушкина Наталья", "HR", "65%"],
                ["Романов Роман", "Программист", "89%"]
            ]
        };

        // Функция для обновления таблицы
        function updateTable(team) {
            const teamNameElement = document.getElementById("team-name");
            const tableBody = document.getElementById("table-body");

            // Обновить название команды
            teamNameElement.textContent = team;

            // Обновить содержимое таблицы
            tableBody.innerHTML = teamData[team]
                .map(row => `<tr><td>${row[0]}</td><td>${row[1]}</td><td>${row[2]}</td></tr>`)
                .join("");
        }

        // Функция для применения выбранной команды
        function applyTeam() {
            const selectedTeam = document.getElementById("team-select").value;
            updateTable(selectedTeam);
        }

        // Установить данные для команды 1 при загрузке
        window.onload = () => updateTable("team1");
    </script>
{% endblock %}